\documentclass[12pt, a4paper, final]{article}

\usepackage{cmap}
\usepackage[T2A]{fontenc}
\usepackage{mathtext}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\usepackage{graphicx}
\usepackage{color}
\usepackage{float}
\usepackage{wrapfig}
\usepackage{pgfplots, pgfplotstable}
\pgfplotsset{compat=1.9}

\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{cancel}
\usepackage{mathrsfs}
\usepackage{icomma}
\mathtoolsset{showonlyrefs=true}
\pagestyle{empty}

\begin{document}

\begin{center}

    \textsc{\LARGE Московский Физико-Технический Институт}\\[1,5cm]
    \textsc{\Large Параллельное программирование}\\[0,5cm]
    \textsc{\large Лабораторная работа \textnumero 1}\\[1cm]

    \noindent\rule{\textwidth}{1pt}
    \\[0.5cm]
    { \huge \bfseries Уравнение переноса}
    \\[0.1cm]
    \noindent\rule{\textwidth}{1pt}
\end{center}

\vspace{1cm}

В данной работе предлагается ознакомиться с реализацией явной центральной трехточечной схемы для нахождения приближенного решения уравнения переноса:
\begin{equation*}
\begin{cases}
\dfrac{\partial u(t,x)}{\partial t} + A \cdot \dfrac{\partial u(t, x)}{\partial x} = f(t, x)\\
u(0, x) = \varphi(x)\\
u(t, 0) = \psi(t)\\
u(t, X) = \psi'(t)
\end{cases}
~~~~~
\begin{cases}
0 \leq x \leq X = 1\\
0 \leq t \leq T = 1
\end{cases}
\end{equation*}

В нашем случае разностная схема будет иметь следующий вид:
\begin{equation*}
\dfrac{u_m^{k+1} - 0.5 (u_{m + 1}^k + u_{m - 1}^k)}{\tau} + A \cdot \dfrac{u_{m + 1}^k - u_{m - 1}^k}{2h} = f_m^k
\end{equation*}
\begin{equation*}
\begin{cases}
t = k \tau\\
x = m h
\end{cases}
~~~~~
\begin{cases}
0 \leq k \leq K = 40\\
0 \leq m \leq M = 20
\end{cases}
~~~~~
\begin{cases}
T = K \tau\\
X = M h
\end{cases}
~~~~~
A = 0.5
\end{equation*}

Начальные условия --- $ \varphi(x), \psi(t), \psi'(t) $ --- для задачи подобраны так, чтобы они удовлетворяли уравнению $ u(t, x) = \sin(\pi (t + 0.5)) \sin(\pi x) $.\\

Программа выводит данные (таблицу) для построения графиков: значения функции $ u(t, x) = \sin(\pi (t + 0.5)) \sin(\pi x) $ на выбранной сетке и результат работы явной центральной трехточечной схемы.\\

Распараллеливание реализовано для подсчета каждого последующего слоя по времени согласно стандарту MPI.

\begin{quote}
Данные приведены для случая $ K = 40, M = 20 $ в следствие ограниченности ресурсов среды \LaTeX.
\end{quote}

\vfill

\begin{minipage}[b]{0.33\textwidth}
    \textit{Выполнил:}\\
    Р.Р. Валиев, 715 гр.\\\\
    \textit{Проверил:}\\
    А.С. Герасимов
\end{minipage}

\newpage

{\centering \subsection*{Искомая функция для сравнения с результатами работы.}}

\begin{center}
\begin{tikzpicture}
\begin{axis}[
view={210}{10},
xmin=0,
xmax=1,
ymin=0,
ymax=1,
grid=both, xlabel={x}, ylabel={t}, zlabel={$ u(x, t) = \sin(\pi (t + 0.5)) \sin(\pi x) $}, title={\text{Искомая функция}}]
\addplot3[surf,samples=50,domain=0:1]
{sin(180 * (y + 0.5)) * sin(180 * x)};
\end{axis}
\end{tikzpicture}
\end{center}

{\centering \subsection*{Сравнение значений для оценки результата работы.}}

\begin{tikzpicture}
\begin{axis}[view={120}{10}, grid=both, xlabel={k}, ylabel={m}, title={\text{Точные значения}}]
\addplot3[surf, mesh/rows=41] file {DATA_EXACT.txt};
\end{axis}
\end{tikzpicture}
\begin{tikzpicture}
\begin{axis}[view={120}{10}, grid=both, xlabel={k}, ylabel={m}, title={\text{Результат работы ЯС}}]
\addplot3[surf, mesh/rows=41] file {DATA.txt};
\end{axis}
\end{tikzpicture}

\newpage

\begin{figure}[H]
	\centering
	\begin{tikzpicture}
	
	\begin{axis}[
	title={Зависимость времени работы от количества процессов (K = 10; M = 100000)},
	width = 0.8\textwidth,
	grid = major,
	xlabel = $ n \text{ - количество процессов} $,
	ylabel = $ T_n \text{, с - потраченное время} $,
	xmin = 1,
	xmax = 12
	]
	
	\addplot[
	only marks,
	color = red,
	mark = *
	]
	coordinates {
		(1,0.026042667)(2,0.027569233)(3,0.026012933)(4,0.0252167)(5,0.027537367)(6,0.024408467)(7,0.028116333)(8,0.030718767)(9,0.077325033)(10,0.123948933)(11,0.170677267)(12,0.201711333)
	};

	\end{axis}
	\end{tikzpicture}
\end{figure}

\begin{figure}[H]
	\centering
	\begin{tikzpicture}
	
	\begin{axis}[
	title={Зависимость ускорения ($ S = \dfrac{T_1}{T_n} $) от количества процессов (K = 10; M = 100000)},
	width = 0.8\textwidth,
	grid = major,
	xlabel = $ n \text{ - количество процессов} $,
	ylabel = $ S \text{ - ускорение} $,
	xmin = 1,
	xmax = 12
	]
	
	\addplot[
	only marks,
	color = red,
	mark = *
	]
	coordinates {
		(1,1)(2,0.944627888)(3,1.001143021)(4,1.032754749)(5,0.945721026)(6,1.066952178)(7,0.926246903)(8,0.847777092)(9,0.336794768)(10,0.210108034)(11,0.152584273)(12,0.129108594)
	};
	
	\end{axis}
	\end{tikzpicture}
\end{figure}

\begin{figure}[H]
	\centering
	\begin{tikzpicture}
	
	\begin{axis}[
	title={Зависимость эффективности ($ E = \dfrac{S}{n} $) от количества процессов (K = 10; M = 100000)},
	width = 0.8\textwidth,
	grid = major,
	xlabel = $ n \text{ - количество процессов} $,
	ylabel = $ E \text{ - эффективность} $,
	xmin = 1,
	xmax = 12
	]
	
	\addplot[
	only marks,
	color = red,
	mark = *
	]
	coordinates {
		(1,1)(2,0.472313944)(3,0.33371434)(4,0.258188687)(5,0.189144205)(6,0.177825363)(7,0.132320986)(8,0.105972136)(9,0.037421641)(10,0.021010803)(11,0.013871298)(12,0.01075905)
	};
	
	\end{axis}
	\end{tikzpicture}
\end{figure}

\newpage

\begin{figure}[H]
	\centering
	\begin{tikzpicture}
	
	\begin{loglogaxis}[
	title={Зависимость времени работы от временной сетки в логарифмических осях},
	width = 0.8\textwidth,
	grid = major,
	xlabel = $ K \text{ - количество временных узлов (n = 4; M = 100)} $,
	ylabel = $ T_K \text{, с - потраченное время} $,
	xmin = 0,
	xmax = 100000
	]
	
	\addplot[
	only marks,
	color = red,
	mark = *
	]
	coordinates {
		(10,0.005650133)(50,0.0072963)(100,0.0120965)(500,0.038580833)(1000,0.0797876)(5000,0.319602433)(10000,0.578973733)(50000,2.963356667)
	};
	
	\end{loglogaxis}
	\end{tikzpicture}
\end{figure}

\begin{figure}[H]
	\centering
	\begin{tikzpicture}
	
	\begin{loglogaxis}[
	title={Зависимость времени работы от пространственной сетки в логарифмических осях},
	width = 0.8\textwidth,
	grid = major,
	xlabel = $ M \text{ - количество пространственных узлов (n = 4; K = 100)} $,
	ylabel = $ T_M \text{, с - потраченное время} $,
	xmin = 0,
	xmax = 100000
	]
	
	\addplot[
	only marks,
	color = red,
	mark = *
	]
	coordinates {
		(10,0.012167967)(50,0.010859133)(100,0.011796167)(500,0.011086833)(1000,0.011018067)(5000,0.019265133)(10000,0.0303361)(50000,0.112914033)
	};
	
	\end{loglogaxis}
	\end{tikzpicture}
\end{figure}

\end{document}
